(function(a){a.fn.extend({fileClick:function(b){var c={hoverClass:"jUploadButtonHover",ItemTemplate:'<li class="{ItemSelector}"><a href="#" class="jRemoveFile">X</a>{FileName}</li>',InputID:"InputID",InputName:"Files",ItemSelector:"jFile",inputDefaultClass:"jInputFile"},b=a.extend({},c,b);return this.each(function(j){var e=b,d=a(this),n=d.find(".jAttachDocument"),r=d.find(".jFileInputContainer"),k=d.find(".jNoAttachments"),s=d.find(".jUploadList");var p=function(){var i=[];return{add:function(o){i.push(o)},remove:function(o){i.splice(o-1,1)},count:function(){return i.length},names:function(){return i}}}();function m(){var i=h.getValue().match(/[^\/\\]+$/)[0];if(q(i)){alert("Ya existe un fichero con ese nombre")}else{g(i)}n.removeClass(e.hoverClass);l()}function g(t){var o,i;p.add(t);o=e.ItemTemplate;o=o.replace("{ItemSelector}",e.ItemSelector).replace("{FileName}",t);i=h.getInstance().unbind().attr({id:e.InputID+j+"_"+p.count(),name:e.InputName+j+"[]"}).css({top:-3000});o=a(o).append(i);s.append(o);if(p.count()>0&&k.is(":visible")){k.hide()}}function f(i){p.remove(i.index());i.remove();if(p.count()==0){k.show()}}d.delegate(".jRemoveFile","click",function(o){o.preventDefault();var i=a(this).parents("."+e.ItemSelector);f(i)});function q(v){var o=p.names(),t=o.length,u=false;while(t--&&!u){u=o[t]==v}return u}var h={setInstance:function(i){this.newInput=i},getInstance:function(){return this.newInput},getValue:function(){return this.newInput.val()}};var l=(function(){function i(){var o=a("<input type='file' class='"+e.inputDefaultClass+"' id='"+e.InputID+j+"' name='"+e.InputName+j+"[]' />");h.setInstance(o);o.bind("mouseover mouseout",function(){n.toggleClass(e.hoverClass)}).change(m);r.html(o)}i();return i})();r.css({width:n[0].offsetWidth,height:n[0].offsetHeight})})}})})(jQuery);